# 性能检测.md

调研负责人：陆诗易



前言：

       前端页面性能对用户留存、用户直观体验有着重要影响，当页面加载时间超过 2 秒后，加载时间每增加一秒，就会有大量的用户流失，所以做好页面性能优化，无疑对网站来说是一个非常重要的步骤。

问题：

      那如何才能知道一个页面的性能情况呢？知道了页面性能情况后又如何进行优化呢？一个页面的性能指标非常多，面对一大堆性能指标，可能一个老手也一时间不知道从何开始分析。而且不同团队，负责
      的业务不同，性能分析的指标也不能够一概而论。打个比方说，对于一般的电商网站，一定会有很多图片，那图片加载的性能提升对网站的性能提升作用就比较大。而对于一些由表单组成的中台页面，提升
图片加载速度的收益远小于电商网站。

需求：

       总结来说，不同的团队有着各自不同的业务，业务之间千差万别，性能指标也不能一概而论，所以用一套统一的检测模型覆盖所有场景是不现实的。需要定制一个属于自己团队的性能检测平台。

产品简介：

      这是一个帮助大家快速评价和分析前端所写页面加载快慢的工具。根据评分结果可以得知页面性能的好坏，测评结果细节和意见将有助于开发分析和改进页面渲染方式，从而逐步提升页面渲染速度。

目前存在的问题：

      1. 部分页面首屏渲染，在没缓存的情况下，超过3s甚至5s
      2. 用户等待时间长导致部分用户流失
      3. 无法快速知道一个页面的性能情况
      4. 即使知道页面性能差也不知从何处开始优化
      5. 各部门业务不同，性能分析不能一概而论

如何解决：

      1. 利用审计工具，根据业务自定义页面性能评分标准
      2. 根据评分结果和优化意见，对页面渲染方式进行合理优化

为什么自己开发：

     1. 国内直接使用免费的Lighthouse扩展插件，存在网络问题，且不支持自动化登录和业务定制化的需求。
     2. 除Lighthouse扩展插件之外的现成工具，比如阿里的前端监控、政采云的百策都需要收费。

解决的问题：

     1. 帮助开发和测试自动化分析页面性能，免去了前端思考以及测试抓包分析的过程
     2. 提出的建议间接帮助前端找到代码的优化方式，短时间内高效修改代码，提升页面加载速度

带来的收益：

     1. 页面渲染速度快，行情交易迅速，用户访问量和交易次数间接提升

最初计划：

     1月底，在本地环境完成系统最基础的功能

实际变化：

     1. 紧急插入项目，时间计划调整
     2. 预计2月初在本地环境开发联调完成
     3. 预计2月中旬部署到云端

系统基础功能：

    1. 页面爬虫
    2. 防反爬
    3. 展示页面各阶段加载时间：从DNS到页面加载完成
    4. 展示页面性能评分结果
    5. 展示页面性能优化意见
    6. 数据入库支持查询


技术方案：

    1. Lighthouse：是一个开源的自动化工具，用于分析和改善 Web 应用的质量
    2. Puppeteer： 是一个开源的自动化工具，用来模拟 Chrome 浏览器的运行
    3. express：     选择各种 HTTP 实用工具和中间件，快速方便地创建强大的API
    4. MongoDB： 一个基于分布式文件存储的开源数据库系统
    5. NodeJs:       运行在服务端的JavaScript
    6. ElementUI:  UI框架
    7. Vue+Ts:      渲染框架

任务拆分：

    1.  爬虫脚本开发
    2.  防反爬机制设计
    3.  审计脚本开发
    4.  Api设计编写
    5.  数据入库
    6.  页面设计
    7.  接口联调
    8.  单页展示
    9.  代码审核
    10. 容器申请、持续部署平台配置
    11. 前端容器环境搭建
    12. 本地项目自测
    13. 生产环境部署