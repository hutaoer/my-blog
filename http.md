# http

## 对象存储与CDN
* 对象存储的核心是存储，以及计算能力(图片处理)，CDN的核心是分发，本身不会给用户提供直接操作存储的入口，所以一般是两者配合使用。对象存储里面存的就是一些图片、视频、文件等等，都是静态数据，正好适合用CDN做加速。用户要做的就是购买CDN服务，并把静态数据URL添加到CDN的加速域名列表中。
* OSS加速和CDN是两个概念。
* CDN 让数据离用户更近一点。CDN(Content Delivery Network)是内容分发网络。基本思路就是在网络各处部署服务节点，系统实时地根据网络流量、负载状况、服务节点到用户的响应时间等信息，自动将用户请求到导向离用户最近的节点上。目的就是让用户就近取得数据，提高响应速度。
* CDN 是一个内容分发网络，通过对源网站资源的缓存，利用本身多台位于不同 地域、不同运营商的服务器，向用户提供资源就近访问的功能。也就是说，用户 的请求并不是直接发送给源网站，而是发送给 CDN 服务器，由 CDN 服务器 将请求定位到最近的含有该资源的服务器上去请求。这样有利于提高网站的访问 速度，同时通过这种方式也减轻了源服务器的访问压力。

## http1.0 和 http1.1区别
* 缓存控制，在 HTTP1.0 中主要使用 header 里的 If-Modified-Since、 Expires 来作为缓存判断的标准，HTTP1.1 则引入了更多的缓存控制策略例 如 E- tag、If-Unmodified-Since、If-Match、If-None-Match 等更多可供选择 的缓存头来控制缓存策略。
* 带宽优化及网络连接的使用
* 错误通知的管理：在 HTTP1.1 中新增了 24 个错误状态响应码，如 409 （Conflict） 表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务 器的某个资源被永久性的删除
* 长连接：HTTP1.1 支持长连接（PersistentConnection）和请求的流水线 （Pipelining）处理。在 HTTP1.1 中默认开启 Connection: keep-alive，一定程度上弥补了 HTTP1.0 每次请求都要创建连接的缺点。

## 简单讲解一下 http2 的多路复用
* 在 HTTP/1 中，每次请求都会建立一次 HTTP 连接，也就是我们常说的 3 次握 手和 4 次挥手，这个过程在一次请求过程中占用了相当长的时间，即使开启 了 Keep-Alive，解决了多次连接的问题，但是依然有两个效率上的问题，一是串 行的文件传输，二是连接数过多导致的性能问题。
* HTTP/2 的多路复用就是为了解决上述的两个性能问题。
* 在 HTTP/2 中，有两个非常重要的概念，分别是帧（frame）和流（stream）。 帧代表着最小的数据单位，每个帧会标识出该帧属于哪个流，流也就是多个帧组 成的数据流。
* 多路复用，就是在一个 TCP 连接中可以存在多条流。换句话说，也就是可以发 送多个请求，对端可以通过帧中的标识知道属于哪个请求。通过这个技术，可以 避免 HTTP 旧版本中的队头阻塞问题，极大的提高传输性能。

## HTTPS 握手过程
* 客户端使用 https 的 url 访问 web 服务器，要求与服务器建立 ssl 连接
* web 服务器收到客户端请求后，会将网站的证书（包含公钥）传送一份 给客户端。公钥和私钥是通过一种算法得到的一个密钥对(即一个公钥和一个私钥)，其中的一个向外界公开，称为公钥；另个自己保留，称为私钥。
* 客户端收到网站证书后会检查证书的颁发机构以及过期时间，如果没有问 题就随机产生一个秘钥；
* 客户端利用公钥将会话秘钥加密，并传送给服务端，服务端利用自己的私钥解密出会话秘钥；
* 之后服务器与客户端使用秘钥加密传输；

## HTTPS 握手过程中，客户端如何验证证书 的合法性
* 首先浏览器读取证书中的证书所有者、有效期等信息进行校验，校验证书的网站域名是否与证书颁发的域名一致，校验证书是否在有效期内；
* 查找操作系统中授信人的证书发布机构CA，校验证书是否为合法机构颁发；
* 如果找不到，浏览器就会报错
* 如果找到，那么浏览器就会从操作系统中取出颁发者 CA 的公钥

## 介绍下如何实现 token 加密
* 需要一个 secret（随机数）； 
* 后端利用 secret 和加密算法（如：`HMAC-SHA256`）对 payload（如账 号密码）生成一个字符串（token），返回前端；
* 前端每次 request 在 header 中带上 token; 
* 后端用同样的算法解密；

## HTTPS 中间人攻击

## 你知道的 HTTP 状态码及其功能
* 200~299：2开头的都是请求成功
* 300~399：重定向，301，永久重定向（SEO）；302：临时重定向；304：协商缓存。
* 400~499：客户端错误，401未授权，403：拒绝请求；404：找不到资源
* 500~599：服务端错误，502 错误网关，503：服务不可用

## 从输入 URL 到页面加载的全过程
* 浏览器获取用户输入，等待 url 输入完毕，敲回车
* 解析 URL，分析协议头，再分析主机名是域名还是 IP 地址；
* 如果主机名是域名的话，则发送一个 DNS 查询请求到 DNS 服务器，获 得主机 IP 地址
* 使 用 DNS 获 取 到 主 机 IP 地 址 后 ， 向 目 的 地 址 发 送 一 个 （http/https/protocol）请求，并且在网络套接字上自动添加端口信息
* 三次握手
* https 需要校验证书
* 等待服务器响应结果
* 得到html 文档，解析文档为DOM tree，解析CSS tree，布局、绘制。
* 执行js

## http2.0
* HTTP2.0 的多路复用，把多个请求当做多个流，请求响应数据分成多个帧，不同流中的帧交错发送，解决了 TCP 连接数量多，TCP 连接慢，所 以对于同一个域名只用创建一个连接就可以了。避免多次链接。
* HTTP2.0 压缩消息头，避免了重复请求头的传输，又减少了传输的大小；
* HTTP2.0 可以设置请求优先级，可以按照优先级来解决阻塞的问题
* HTTP2.0 服务端推送，浏览器发送请求后，服务端会主动发送与这个请 求相关的资源，之后浏览器就不用再次发送后续的请求了；

